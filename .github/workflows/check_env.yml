name: Custom Environment Check

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

permissions:
  contents: read

jobs:
  custom_env_check:
    runs-on: ubuntu-latest

    steps:
      - name: Check out code
        uses: actions/checkout@v4

      # Run using Python 3.11
      - name: Set up Python 3.11
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
          architecture: 'x64'
          cache: pip
          cache-dependency-path: '**/requirements.txt'

      # Install gymnasium and stable-baselines3 libraries
      - name: Install gym and stable-baselines3
        run: |
          pip install numpy gym gymnasium
          pip install stable-baselines3

      - name: Check Custom Environment
        run: |
          python -c "from stable_baselines3.common.env_checker import check_env; from custom_environment.environment_factory import init_custom_factory_env; check_env(init_custom_factory_env(is_verbose=True))"
